count(file,word, sort = TRUE) %>%
ungroup()
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>%
ungroup()
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>%
ungroup()
book_words
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = total)
book_words <- as.data.table(book_words)
book_words$class <- myDataset[match(book_words$file,myDataset$file),"class"]
setkey(book_words,file,word,class)
write.csv(book_words,file = "tf-idf.csv")
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>%
ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = n)
book_words <- as.data.table(book_words)
book_words$class <- myDataset[match(book_words$file,myDataset$file),"class"]
setkey(book_words,file,word,class)
write.csv(book_words,file = "tf-idf.csv")
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) #%>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) #%>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(tbl = word, document = file, n = n)
book_words <- as.data.table(book_words)
book_words$class <- myDataset[match(book_words$file,myDataset$file),"class"]
setkey(book_words,file,word,class)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(tbl = book_words$word, document = file, n = n)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(tbl = total,term = word, document = file, n = n)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(tbl = total, document = file, n = n)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = n)
book_words <- as.data.table(book_words)
book_words$class <- myDataset[match(book_words$file,myDataset$file),"class"]
setkey(book_words,file,word,class)
write.csv(book_words,file = "tf-idf.csv")
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
total_words
myDataset
unnest_tokens(word, text,to_lower = TRUE)
myDataset %>%
unnest_tokens(word, text,to_lower = TRUE)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
book_words
book_words <- myDataset %>%
unnest_tokens(file, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
book_words <- myDataset %>%
unnest_tokens(file, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
myDataset
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% group()
myDataset
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file, sort = TRUE) #%>% ungroup()
total_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file, sort = TRUE) #%>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file, sort = TRUE) #%>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file, sort = TRUE) %>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file, sort = TRUE) %>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words
total_words <- book_words %>% group_by(file) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
book_words
book_words <- left_join(book_words, total_words, by = "file")
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file, sort = TRUE) %>% ungroup()
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
book_words
total_words <- book_words %>% group_by(file) %>% summarize(total = sum(n))
total_words
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
total_words
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
book_words
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(tbl = myDataset$text,term = word, document = file, n = n)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(tbl = word,term = word, document = file, n = n)
arrange(desc(tf_idf))
arrange(desc(book_words))
head(book_words)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = n)
book_words <- as.data.table(book_words)
book_words$class <- myDataset[match(book_words$file,myDataset$file),"class"]
setkey(book_words,file,word,class)
write.csv(book_words,file = "tf-idf.csv")
book_words
arrange(desc(book_words))
arrange(desc(tf-idf))
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = n) %>% arrange(desc(tf_idf))
book_words
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = n)
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
# Create matrix with TF-IDF
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = n)
book_words
book_words <- as.data.table(book_words)
book_words
sum(book_words$n)
library(dplyr)
library(tidytext)
library(ggplot2)
library(tm)
library(dtplyr)
library("data.table")
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
book_words
total_files <- book_words %>% group_by(word,file) %>% summarize(total = sum(n))
total_files
total_files <- total_files %>% group_by(word) %>% summarize(total = sum(n))
total_files <- total_files %>% group_by(word) %>% summarize(n = sum(n))
total_files
total_files <- book_words %>% group_by(word,file) %>% summarize(total = count(n))
book_words
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(n))
total_words
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
total_words
total_files <- total_word %>% group_by(file) %>% summarize(n = sum(n))
total_files
total_files <- total_word %>% group_by(file) %>% summarize(n = sum(n))
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
total_files <- total_word %>% group_by(file) %>% summarize(n = sum(n))
total_files <- total_words %>% group_by(file) %>% summarize(n = sum(n))
source('D:/Data Science/r/tf-idf/tf-idf.R', echo=TRUE)
total_words
total_files <- total_words %>% group_by(file) %>% summarize(n = count(n))
total_files
total_words
total_files <- total_words %>% group_by(word,file) %>% summarize(n = count(n))
total_words
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
total_words
total_files <- total_words %>% group_by(word,file) %>% summarize(n = count(n))
library(dplyr)
library(tidytext)
library(ggplot2)
library(tm)
library(dtplyr)
library("data.table")
total_words
total_files
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
book_words
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
total_words
total_files <- total_words %>% group_by(word) %>% summarize(n = count(n))
total_words
total_files <- total_words %>% group_by(word) %>% summarize(n = count(n))
total_files <- total_words %>% group_by(word) %>% summarize(n = sum(n))
total_files <- total_words %>% group_by(word) %>% summarize(n = count(word))
total_files <- total_words %>% group_by(word) %>% summarize(n = count(n))
total_files <- total_words %>% group_by(word) %>% summarize(n = sum(n))
total_files <- total_words %>% group_by(word) %>% summarize(total = sum(n))
total_files <- book_words %>% group_by(word) %>% summarize(total = sum(n))
total_files
total_files <- book_words %>% group_by(word) %>% summarize(total = count(n))
total_files <- book_words %>% group_by(file,word) %>% summarize(total = count(n))
total_files <- book_words %>% group_by(file) %>% summarize(total = sum(n))
total_files
total_files <- book_words %>% group_by(word,file) %>% summarize(total = sum(n))
total_files
total_files <- total_words %>% group_by(word,file) %>% summarize(total = sum(n))
total_words
total_files <- as.data.frame(total_words) %>% group_by(word,file) %>% summarize(total = sum(n))
total_files <- as.data.frame(total_words) %>% group_by(word) %>% summarize(total = sum(n))
total_files <- as.data.frame(total_words) %>% group_by(word) %>% summarize(total = count(n))
total_files <- as.data.frame(total_words) %>% group_by(word) %>% summarize(n = count(n))
total_words
as.data.frame(total_words)
total_files <- as.data.frame(total_words[-3]) %>% group_by(word) %>% summarize(n = count(n))
total_files <- as.data.frame(total_words[-3]) %>% group_by(word) %>% summarize(n = sum(n))
total_files <- as.data.frame(total_words[,-3]) %>% group_by(word) %>% summarize(n = sum(n))
total_files <- as.data.frame(total_words[,-3]) %>% group_by(word) %>% summarize(total = sum(n))
total_words[,-3]
total_files <- total_words[,-3] %>% group_by(word) %>% summarize(total = sum(n))
total_files <- book_words %>% group_by(word) %>% summarize(total = sum(n))
total_files
total_files <- total_words %>% group_by(word) %>% summarize(total = sum(n))
log(4/2)
log(4/3)
log(1+4/3)
log(1+4/2)
log(1+4/3)
log10(1+4/3)
log10(4/3)
log10(4/2)
log(1+4)*log10(4/2)
log(4)
1+log(4)
1+log10(4)
1+log2(4)
1+log2(4)*log2(4/2)
1+log2(4)*log2(4/3)
log2(4/3)
log2(4/2)
log2(4/1)
log2(2)*log2(4/2)
1+log2(2)*log2(4/2)
1+log2(3)*log2(4/3)
1+log2(2)*log2(4/3)
1+log2(2)*log10(4/3)
1+log2(2)*log(4/3)
1+log2(2)*log2(4/3)
1+log2(2)*log2(4/2)
1+log2(3)*log2(4/3)
1+log2(3)
log2(4/3)
1+log2(3)*log2(4/3)
log2(4/3)
1+log2(3)
library(dplyr)
library(tidytext)
library(ggplot2)
library(tm)
library(dtplyr)
library("data.table")
df <- read.csv2("baeza.txt")
df <- read.csv2("baeza.txt",header = T,sep = ",")
book_words <- df %>% bind_tf_idf(term = term, document = c("tf1","tf2","tf3","tf4"), n = n)
book_words <- df$term
book_words <- cbind(file = rep("d1",13),word = df$term)
book_words
df <- read.csv2("baeza.txt",header = T,sep = ",",stringsAsFactors = F)
book_words <- cbind(file = rep("d1",13),word = df$term)
book_words
book_words <- cbind(file = rep("d1",13),word = df$term,tf = df$tf1,n = df$n)
book_words
book_words <- cbind(file = rep("d1",13),word = df$term,tf = df$tf1,n = df$n)
book_words2 <- cbind(file = rep("d1",13),word = df$term,tf = df$tf2,n = df$n)
book_words3 <- cbind(file = rep("d1",13),word = df$term,tf = df$tf3,n = df$n)
book_words4 <- cbind(file = rep("d1",13),word = df$term,tf = df$tf4,n = df$n)
book_words1 <- cbind(file = rep("d1",13),word = df$term,tf = df$tf1,n = df$n)
book_words <- rbind(book_words1,book_words2,book_words3,book_words4)
book_words
book_words1 <- cbind(file = rep("d1",13),word = df$term,tf = df$tf1,n = df$n)
book_words2 <- cbind(file = rep("d2",13),word = df$term,tf = df$tf2,n = df$n)
book_words3 <- cbind(file = rep("d3",13),word = df$term,tf = df$tf3,n = df$n)
book_words4 <- cbind(file = rep("d4",13),word = df$term,tf = df$tf4,n = df$n)
book_words <- rbind(book_words1,book_words2,book_words3,book_words4)
book_words
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4))
book_words
book_words <- df %>% bind_tf_idf(term = term, document = c("tf1","tf2","tf3","tf4"), n = n)
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4),stringsAsFactors = F)
book_words <- df %>% bind_tf_idf(term = word, document = file, n = tf)
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = tf)
book_words1 <- cbind(file = rep("d1",13),word = df$term,tf = df$tf1,n = df$n)
book_words2 <- cbind(file = rep("d2",13),word = df$term,tf = df$tf2,n = df$n)
book_words3 <- cbind(file = rep("d3",13),word = df$term,tf = df$tf3,n = df$n)
book_words4 <- cbind(file = rep("d4",13),word = df$term,tf = df$tf4,n = df$n)
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4),stringsAsFactors = F)
book_words$tf <- as.integer(book_words$tf)
book_words$n <- as.integer(book_words$n)
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = tf)
book_words
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4),stringsAsFactors = F)
book_words$tf <- as.integer(book_words$tf)
book_words$n <- as.integer(book_words$n)
book_words <- book_words %>% bind_tf_idf(term = word, document = file, n = n)
book_words
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4),stringsAsFactors = F)
book_words$tf <- as.integer(book_words$tf)
book_words$n <- as.integer(book_words$n)
1+log(book_words$tf)*log(4/book_words$n)
1+log(1+book_words$tf)*log(4/book_words$n)
1+log(1+book_words$tf)
book_words
book_words$tf <- 1+log(1+book_words$tf)
book_words
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4),stringsAsFactors = F)
book_words$tf <- as.integer(book_words$tf)
book_words$n <- as.integer(book_words$n)
book_words$tfi <- 1+log(1+book_words$tf)
book_words$idf <- log(4/book_words$n)
book_words
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4),stringsAsFactors = F)
book_words$tf <- as.integer(book_words$tf)
book_words$n <- as.integer(book_words$n)
bw
book_words[1:13,]
book_words$tfi <- 1+log(1+book_words$tf)
book_words
book_words$tfi <- 1+log2(1+book_words$tf)
book_words
book_words$tfi <- 1+log2(book_words$tf)
book_words
book_words$idf <- log(4/book_words$n)
book_words
book_words$idf <- log2(4/book_words$n)
book_words
book_words$tf_idf <- book_words$tfi * book_words$idf
book_words
df
df1 <- readChar(con = "doc1.txt",nchars = 100)
df2 <- readChar(con = "doc2.txt",nchars = 100)
df3 <- readChar(con = "doc3.txt",nchars = 100)
df4 <- readChar(con = "doc4.txt",nchars = 100)
df1 <- cbind("doc1.txt",df1,"1")
df2 <- cbind("doc2.txt",df2,"2")
df3 <- cbind("doc3.txt",df3,"3")
df4 <- cbind("doc4.txt",df4,"4")
myDataset <- data.frame(stringsAsFactors = FALSE)
datasetTemp <- as.data.frame(rbind(df1,df2,df3,df4),stringsAsFactors = F)
names(datasetTemp) <- c("id","text","class")
datasetTemp
ct <- 0         # counter to read files
for(ind in 1:length(datasetTemp$id)) {
texto <- datasetTemp$text[ind]
texto <- paste(texto,collapse = " ")
texto <- gsub("<.*?>", "", texto)
documents <- Corpus(VectorSource(texto))
documents = tm_map(documents, tolower)
documents = tm_map(documents, removePunctuation)
texto  = tm_map(documents, removeNumbers)$content
#texto <- tm_map(documents, removeWords,stopwords("en"))$content
myDataset <- rbind(myDataset,c(datasetTemp$id[ind],datasetTemp$class[ind],
t(texto)),deparse.level = 0, stringsAsFactors =  FALSE)
}
myDataset
myDataset <- data.frame(lapply(myDataset,as.character), stringsAsFactors = FALSE)
myDataset
colnames(myDataset) <- c("file","class","text")
myDataset
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup()
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% order_by(file)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% order_by(call = file)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% order(file)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% sort(file)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% sort()
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% order(file)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% order_by(file)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame() %>% order_by(sum)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
book_words <- book_words[order(book_words$file),]
book_words
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
total_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
book_words <- book_words[order(book_words$file),]
book_words
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
total_words
book_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
book_words <- book_words[order(book_words$file),]
book_words
head(book_words)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
head(book_words)
names(book_words) <- c("file","word","f")
book_words
head(book_words)
book_words <- book_words %>% group_by(file,word) %>% summarize(n = sum(n))
book_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(n))
book_words %>% group_by(file,word) %>% summarize(total = sum(n))
book_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(f))
book_words
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
book_words <- book_words[order(book_words$file),]
names(book_words) <- c("file","word","f")
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(f))
total_words
book_words <- left_join(total_words, total_words, by = "word")
head(book_words)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
book_words <- book_words[order(book_words$file),]
names(book_words) <- c("file","word","f")
total_words <- book_words %>% group_by(file,word) %>% summarize(total = sum(f))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
book_words <- myDataset %>%
unnest_tokens(word, text,to_lower = TRUE) %>%
count(file,word, sort = TRUE) %>% ungroup() %>% as.data.frame()
names(book_words) <- c("file","word","f")
book_words <- book_words[order(book_words$file),]
total_words <- book_words %>% group_by(word) %>% summarize(total = sum(f))
book_words <- left_join(book_words, total_words, by = "word")
head(book_words)
df <- read.csv2("baeza.txt",header = T,sep = ",",stringsAsFactors = F)
df
book_words1 <- cbind(file = rep("d1",13),word = df$term,tf = df$tf1,n = df$n)
book_words2 <- cbind(file = rep("d2",13),word = df$term,tf = df$tf2,n = df$n)
book_words3 <- cbind(file = rep("d3",13),word = df$term,tf = df$tf3,n = df$n)
book_words4 <- cbind(file = rep("d4",13),word = df$term,tf = df$tf4,n = df$n)
book_words <- as.data.frame(rbind(book_words1,book_words2,book_words3,book_words4),stringsAsFactors = F)
book_words$tf <- as.integer(book_words$tf)
book_words$n <- as.integer(book_words$n)
book_words$tfi <- 1+log2(book_words$tf)
book_words$idf <- log2(4/book_words$n)
book_words$tf_idf <- book_words$tfi * book_words$idf
book_words
